function maplocation(a,b,c,d){var e=this;e.position=a,e.latlng=new google.maps.LatLng(a[0],a[1]),e.name=b,e.type=c,e.loaded=!1,e.icon="icons/"+c.toLowerCase()+".png",e.flickr=ko.observable('<img src="images/ajax-loader.gif">'),e.foursquare=ko.observable('<img src="images/ajax-loader.gif">'),e.visibleMarker=ko.observable(!0),e.selected=ko.observable(!1),e.marker=new google.maps.Marker({position:e.latlng,title:e.name,map:map,icon:e.icon}),e.popup=new google.maps.InfoWindow({content:"<div><h3>"+b+"</h3></div>"}),e.popupdate=ko.computed(function(){var a='<div class="container-fluid popup"><div class="row popup"><div class="col-md-12"><h3>'+e.name+'</h3></div></div><div class="row">'+e.flickr()+e.foursquare()+"</div></div>";e.popup.setContent(a)}),e.selectMarker=ko.computed(function(){e.loaded||(getFlickr(e.position,e.name,e.flickr,e.foursquare,e.type),e.loaded=!0)}),e.toggleSelected=function(){d(e.selected)},google.maps.event.addListener(e.marker,"click",function(a){return a}(e.toggleSelected)),google.maps.event.addListener(e.popup,"closeclick",function(a){return a}(e.toggleSelected)),e.hideButton=function(){e.visibleMarker(!1)},e.showButton=function(){e.visibleMarker(!0)}}function markerViewModel(){self=this,self.showhideMarkers=function(a){var b=a();self.locations.forEach(function(a){a.selected(!1)}),a(!b)},self.locations=function(){var a=[];return localMarkers.forEach(function(b){a.push(new maplocation(b.position,b.title,b.type,self.showhideMarkers))}),a.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}),a}(),self.search=function(){var a=$("#searchbox").val().toLowerCase();self.locations.forEach(a.length>0?function(b){b.visibleMarker(b.name.toLowerCase().includes(a)?!0:!1)}:function(a){a.visibleMarker(!0)})},self.showhide=ko.computed(function(){self.locations.forEach(function(a){a.selected()?(a.popup.open(map,a.marker),a.marker.setAnimation(google.maps.Animation.BOUNCE)):(a.popup.close(),a.marker.setAnimation(null))})})}function initialise(){var a=document.getElementById("map-container"),b={center:new google.maps.LatLng(53.34486891755311,-6.258903140600515),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:mapStyles};map=new google.maps.Map(a,b),ko.applyBindings(new markerViewModel)}var map,mapStyles=[{featureType:"water",elementType:"geometry",stylers:[{visibility:"on"},{color:"#59a6dd"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#0cca8a"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{visibility:"off"}]}],localMarkers=[{title:"Capel Street",position:[53.346773,-6.267874],type:"restaurant"},{title:"Dublin Castle",position:[53.343174,-6.267567],type:"restaurant"},{title:"Georges Street",position:[53.343762,-6.264677],type:"bar"},{title:"Abby Street",position:[53.348746,-6.257595],type:"entertainment"},{title:"Trinity College",position:[53.344401,-6.25733],type:"historic"},{title:"Dame Street",position:[53.344252,-6.262458],type:"restaurant"},{title:"Temple bar",position:[53.345588,-6.263162],type:"bar"},{title:"Millenium Walkway",position:[53.347149,-6.265395],type:"restaurant"},{title:"O'Connell Street",position:[53.349884,-6.260418],type:"shopping"},{title:"Jervis Street",position:[53.348098,-6.266392],type:"shopping"},{title:"Merrion Square",position:[53.339656,-6.24918],type:"art"},{title:"St Stephens Green",position:[53.338197,-6.259118],type:"art"},{title:"Grafton Street",position:[53.341731,-6.260119],type:"shopping"},{title:"Henry Street",position:[53.349456,-6.262274],type:"shopping"}],categories={art:"4bf58dd8d48988d166941735",shopping:"4d4b7105d754a06378d81259",restaurant:"4d4b7105d754a06374d81259",entertainment:"4bf58dd8d48988d1f2931735",historic:"4bf58dd8d48988d190941735",bar:"4d4b7105d754a06376d81259"},getFlickr=function(a,b,c,d,e){var f="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=7abca36c88c5c619545ef842155974d9&lat="+a[0]+"&lon="+a[1]+"&radius=0.01&per_page=8&page=1&format=json";$.ajax(f,{dataType:"jsonp",jsonp:"jsoncallback",timeout:5e3,success:function(a){var b=a.photos.photo,d='<div class="flickr col-md-7 col-sm-7">';for(i=0;i<b.length;i++){var e="https://farm"+b[i].farm+".staticflickr.com/"+b[i].server+"/"+b[i].id+"_"+b[i].secret+"_q.jpg",f='<div><img class="img-responsive" src="'+e+'"></div>';d+=f}d+="</div>",c(d)},error:function(a,b,d){var e='<div class="flickr col-md-7 col-sm-7">';e+="<h4>Sorry, this content isn't loading right now.</h4><p>"+b+": "+d+"</p>",e+="</div>",c(e)}});var g="https://api.foursquare.com/v2/venues/search/?ll="+a[0]+","+a[1]+"&radius=200&categoryId="+categories[e]+"&intent=browse&limit=8&client_id=JILQ425OSSB1A4PVRXHIOSMZLBMQ2LDZPPSDPBVPYIMLSVDQ&client_secret=RT0YLMXT4DRGCVZLTNKLKBTXHDCHFFPAE5AKZKPQ3SP15Q0R&v=20130815";$.ajax(g,{dataType:"json",success:function(a){var b='<div class="foursquare col-md-5">',c=a.response.venues,f='<div><h4>Nearby FourSquare Locations (<span class="titlecase">'+e+"</span>)</h4></div>";for(i=0;i<c.length;i++){var g=c[i];f+='<div class="singleplace"><div class="placename">'+g.name+"</div>",f+='<div class="placedetails">',void 0!==g.location.formattedAddress[0]&&(f+="Address: "+g.location.formattedAddress[0]),void 0!==g.location.formattedAddress[1]&&(f+=" "+g.location.formattedAddress[1]),void 0!==g.location.formattedAddress[2]&&(f+=" "+g.location.formattedAddress[2]),f+="</div>",void 0!==g.contact.formattedPhone&&(f+='<div class="placedetails">Phone: '+g.contact.formattedPhone+"</div>"),f+="</div>"}b+=f,b+="</div>",d(b)},error:function(a,b,c){var d='<div class="foursquare col-md-5">';d+="<h4>Sorry, this content isn't loading right now.</h4><p>"+b+": "+c+"</p>",(d+="</div>")(flickrStr)}})};google.maps.event.addDomListener(window,"load",initialise);